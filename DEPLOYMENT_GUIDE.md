# LINE èŠå¤©æ©Ÿå™¨äººéƒ¨ç½²æŒ‡å—

## ğŸ“‹ é …ç›®æ¦‚è¿°

æœ¬é …ç›®æ˜¯ä¸€å€‹é›†æˆ **Google Gemini AI** çš„ **LINE èŠå¤©æ©Ÿå™¨äºº**ï¼Œèƒ½å¤ æ¥æ”¶ LINE ç”¨æˆ¶çš„æ¶ˆæ¯ï¼Œé€šé Gemini AI ç”Ÿæˆæ™ºèƒ½å›æ‡‰ï¼Œä¸¦å°‡å›æ‡‰ç™¼é€å›ç”¨æˆ¶ã€‚

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

- âœ… æ¥æ”¶ LINE ç”¨æˆ¶æ¶ˆæ¯
- âœ… ä½¿ç”¨ Google Gemini 2.5 Flash æ¨¡å‹ç”Ÿæˆ AI å›æ‡‰
- âœ… å°‡ AI å›æ‡‰ç™¼é€å› LINE ç”¨æˆ¶
- âœ… 24/7 åœ¨ç·šé‹è¡Œï¼ˆéƒ¨ç½²åœ¨ Render é›²å¹³å°ï¼‰

---

## ğŸ“ é …ç›®çµæ§‹

```
line-gpt-bot/
â”œâ”€â”€ app.py                    # Flask æ‡‰ç”¨ä¸»ç¨‹å¼
â”œâ”€â”€ requirements.txt          # Python ä¾è³´åŒ…åˆ—è¡¨
â”œâ”€â”€ .env                      # ç’°å¢ƒè®Šæ•¸é…ç½®æ–‡ä»¶
â”œâ”€â”€ Procfile                  # Render éƒ¨ç½²é…ç½®
â”œâ”€â”€ runtime.txt              # Python ç‰ˆæœ¬é…ç½®
â”œâ”€â”€ DEPLOYMENT_GUIDE.md      # æœ¬æ–‡ä»¶
â””â”€â”€ README.md                # é …ç›®èªªæ˜
```

---

## ğŸ”‘ æ‰€éœ€çš„ API å¯†é‘°å’Œä»¤ç‰Œ

### 1. LINE Messaging API

| é …ç›® | èªªæ˜ |
|------|------|
| **Channel ID** | 2009075799 |
| **Channel Access Token** | ç”¨æ–¼ç™¼é€æ¶ˆæ¯åˆ° LINE |
| **Channel Secret** | ç”¨æ–¼é©—è­‰ Webhook ç°½å |

**ç²å–æ–¹å¼**ï¼š
- å‰å¾€ [LINE Developers Console](https://developers.line.biz/)
- å‰µå»º Channel æˆ–ä½¿ç”¨ç¾æœ‰ Channel
- åœ¨ Messaging API è¨­ç½®ä¸­ç²å–

### 2. Google Gemini API

| é …ç›® | èªªæ˜ |
|------|------|
| **API Key** | ç”¨æ–¼èª¿ç”¨ Gemini AI æ¨¡å‹ |

**ç²å–æ–¹å¼**ï¼š
- å‰å¾€ [Google AI Studio](https://aistudio.google.com/app/apikey)
- é»æ“Šã€ŒCreate API Keyã€
- è¤‡è£½ç”Ÿæˆçš„å¯†é‘°

---

## ğŸš€ éƒ¨ç½²æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šæº–å‚™ä»£ç¢¼

```bash
# å…‹éš†æˆ–ä¸‹è¼‰é …ç›®
cd line-gpt-bot

# å®‰è£ä¾è³´
pip install -r requirements.txt
```

### æ­¥é©Ÿ 2ï¼šé…ç½®ç’°å¢ƒè®Šæ•¸

**å‰µå»º `.env` æ–‡ä»¶**ï¼š

```env
LINE_CHANNEL_ACCESS_TOKEN=your_line_channel_access_token
LINE_CHANNEL_SECRET=your_line_channel_secret
GEMINI_API_KEY=your_gemini_api_key
```

### æ­¥é©Ÿ 3ï¼šæœ¬åœ°æ¸¬è©¦

```bash
python app.py
```

æ‡‰ç”¨å°‡åœ¨ `http://127.0.0.1:5000` é‹è¡Œ

### æ­¥é©Ÿ 4ï¼šéƒ¨ç½²åˆ° Render

1. **å‰µå»º GitHub å€‰åº«**ï¼ˆå¯é¸ï¼Œä½†æ¨è–¦ï¼‰
2. **å‰å¾€ [Render.com](https://render.com/)**
3. **å‰µå»ºæ–°çš„ Web Service**
4. **é€£æ¥ GitHub å€‰åº«**
5. **é…ç½®ç’°å¢ƒè®Šæ•¸**
6. **éƒ¨ç½²**

### æ­¥é©Ÿ 5ï¼šé…ç½® LINE Webhook

1. **å‰å¾€ LINE Developers Console**
2. **é€²å…¥ Messaging API è¨­ç½®**
3. **è¨­ç½® Webhook URL**ï¼š
   ```
   https://your-render-url.onrender.com/callback
   ```
4. **å•Ÿç”¨ Webhook**

---

## ğŸ“± ä½¿ç”¨èŠå¤©æ©Ÿå™¨äºº

### æ·»åŠ ç‚ºå¥½å‹

1. **æƒæ QR Code**ï¼ˆåœ¨ LINE Developers Console ä¸­æ‰¾åˆ°ï¼‰
2. **æˆ–æœç´¢ Channel ID**ï¼š`2009075799`
3. **é»æ“Šã€ŒåŠ ç‚ºå¥½å‹ã€**

### ç™¼é€æ¶ˆæ¯

1. **æ‰“é–‹èˆ‡èŠå¤©æ©Ÿå™¨äººçš„å°è©±**
2. **è¼¸å…¥ä»»ä½•æ¶ˆæ¯**
3. **ç­‰å¾… AI å›æ‡‰**ï¼ˆé€šå¸¸ 1-3 ç§’ï¼‰

### ç¤ºä¾‹å°è©±

```
ç”¨æˆ¶ï¼šä½ å¥½
æ©Ÿå™¨äººï¼šä½ å¥½ï¼å¾ˆé«˜èˆˆè¦‹åˆ°ä½ ã€‚æœ‰ä»€éº¼æˆ‘å¯ä»¥å¹«åŠ©ä½ çš„å—ï¼Ÿ

ç”¨æˆ¶ï¼šè«‹å¹«æˆ‘å¯«ä¸€é¦–è©©
æ©Ÿå™¨äººï¼š[Gemini AI ç”Ÿæˆçš„è©©]

ç”¨æˆ¶ï¼šä»Šå¤©å¤©æ°£å¦‚ä½•
æ©Ÿå™¨äººï¼š[Gemini AI çš„å›æ‡‰]
```

---

## ğŸ”§ é…ç½®å’Œè‡ªå®šç¾©

### ä¿®æ”¹ AI æ¨¡å‹

åœ¨ `app.py` ä¸­ä¿®æ”¹ï¼š

```python
model = genai.GenerativeModel('gemini-2.5-flash')
```

å¯ç”¨çš„æ¨¡å‹ï¼š
- `gemini-2.5-flash`ï¼ˆæ¨è–¦ï¼Œå¿«é€Ÿä¸”é«˜æ•ˆï¼‰
- `gemini-1.5-pro`ï¼ˆæ›´å¼·å¤§ä½†æ›´æ…¢ï¼‰
- `gemini-1.5-flash`ï¼ˆè¼•é‡ç´šï¼‰

### æ·»åŠ ç³»çµ±æç¤ºè©

```python
response = model.generate_content(
    [
        "ä½ æ˜¯ä¸€å€‹å‹å¥½çš„åŠ©æ‰‹ã€‚",
        user_message
    ]
)
```

### æ”¯æŒå¤šç¨®æ¶ˆæ¯é¡å‹

ç•¶å‰åªæ”¯æŒæ–‡æœ¬æ¶ˆæ¯ã€‚è¦æ”¯æŒåœ–ç‰‡ã€èªéŸ³ç­‰ï¼Œéœ€è¦ä¿®æ”¹ `handle_message` å‡½æ•¸ã€‚

---

## ğŸ“Š ç›£æ§å’Œèª¿è©¦

### æŸ¥çœ‹ Render æ—¥èªŒ

1. **å‰å¾€ Render å„€è¡¨æ¿**
2. **é¸æ“‡æ‚¨çš„æœå‹™**
3. **é»æ“Šã€ŒLogsã€æ¨™ç±¤**
4. **æŸ¥çœ‹å¯¦æ™‚æ—¥èªŒ**

### å¸¸è¦‹éŒ¯èª¤

| éŒ¯èª¤ | åŸå›  | è§£æ±ºæ–¹æ¡ˆ |
|------|------|--------|
| `API key expired` | API å¯†é‘°ç„¡æ•ˆæˆ–éæœŸ | é‡æ–°ç”Ÿæˆ API å¯†é‘° |
| `403 Unauthorized` | LINE ä»¤ç‰Œç„¡æ•ˆ | æª¢æŸ¥ Channel Access Token |
| `Invalid signature` | Webhook ç°½åé©—è­‰å¤±æ•— | æª¢æŸ¥ Channel Secret |
| `Connection timeout` | ç„¡æ³•é€£æ¥åˆ° Render | æª¢æŸ¥ Webhook URL æ˜¯å¦æ­£ç¢º |

---

## ğŸ” å®‰å…¨æœ€ä½³å¯¦è¸

### 1. ä¿è­· API å¯†é‘°

- âœ… ä½¿ç”¨ç’°å¢ƒè®Šæ•¸å­˜å„²æ•æ„Ÿä¿¡æ¯
- âœ… ä¸è¦å°‡å¯†é‘°ä¸Šå‚³åˆ° GitHub
- âœ… å®šæœŸè¼ªæ› API å¯†é‘°
- âŒ ä¸è¦åœ¨ä»£ç¢¼ä¸­ç¡¬ç·¨ç¢¼å¯†é‘°

### 2. é©—è­‰ Webhook

- âœ… é©—è­‰ X-Line-Signature é ­
- âœ… ç¢ºä¿åªæ¥å—ä¾†è‡ª LINE çš„è«‹æ±‚

### 3. é™åˆ¶ API ä½¿ç”¨

- âœ… ç›£æ§ Gemini API ä½¿ç”¨æƒ…æ³
- âœ… è¨­ç½®é…é¡é™åˆ¶
- âœ… å¯¦ç¾é€Ÿç‡é™åˆ¶

---

## ğŸ“ˆ æ€§èƒ½å„ªåŒ–

### 1. ç·©å­˜å›æ‡‰

```python
from functools import lru_cache

@lru_cache(maxsize=100)
def get_cached_response(user_message):
    # ç·©å­˜å¸¸è¦‹å•é¡Œçš„å›æ‡‰
    pass
```

### 2. ç•°æ­¥è™•ç†

```python
import asyncio

async def handle_message_async(event):
    # ç•°æ­¥è™•ç†æ¶ˆæ¯
    pass
```

### 3. æ•¸æ“šåº«å­˜å„²

æ·»åŠ  SQLite æˆ– PostgreSQL ä¾†å­˜å„²å°è©±è¨˜éŒ„ã€‚

---

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œï¼šèŠå¤©æ©Ÿå™¨äººç„¡æ³•æ¥æ”¶æ¶ˆæ¯

**æª¢æŸ¥æ¸…å–®**ï¼š
1. âœ… Webhook URL æ˜¯å¦æ­£ç¢ºé…ç½®
2. âœ… Webhook æ˜¯å¦å·²å•Ÿç”¨
3. âœ… Render æ‡‰ç”¨æ˜¯å¦åœ¨ç·š
4. âœ… Channel Secret æ˜¯å¦æ­£ç¢º

### å•é¡Œï¼šAI å›æ‡‰ç‚ºç©ºæˆ–éŒ¯èª¤

**æª¢æŸ¥æ¸…å–®**ï¼š
1. âœ… Gemini API å¯†é‘°æ˜¯å¦æœ‰æ•ˆ
2. âœ… API é…é¡æ˜¯å¦ç”¨å®Œ
3. âœ… æŸ¥çœ‹ Render æ—¥èªŒä¸­çš„è©³ç´°éŒ¯èª¤

### å•é¡Œï¼šæ‡‰ç”¨é »ç¹å´©æ½°

**æª¢æŸ¥æ¸…å–®**ï¼š
1. âœ… æŸ¥çœ‹ Render æ—¥èªŒ
2. âœ… æª¢æŸ¥ä¾è³´åŒ…ç‰ˆæœ¬
3. âœ… ç¢ºä¿æœ‰è¶³å¤ çš„å…§å­˜

---

## ğŸ“š ç›¸é—œè³‡æº

- [LINE Messaging API æ–‡æª”](https://developers.line.biz/)
- [Google Gemini API æ–‡æª”](https://ai.google.dev/)
- [Flask æ–‡æª”](https://flask.palletsprojects.com/)
- [Render æ–‡æª”](https://render.com/docs)

---

## ğŸ“ æ”¯æŒå’Œåé¥‹

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹ï¼š
1. æŸ¥çœ‹é …ç›®æ—¥èªŒ
2. æª¢æŸ¥ API æ–‡æª”
3. æäº¤ GitHub Issue

---

## ğŸ“„ è¨±å¯è­‰

æœ¬é …ç›®æ¡ç”¨ MIT è¨±å¯è­‰ã€‚

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
